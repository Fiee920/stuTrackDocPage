import{_ as s,c as i,o as a,a4 as e}from"./chunks/framework.CI8or701.js";const F=JSON.parse('{"title":"Redis环境配置","description":"","frontmatter":{},"headers":[],"relativePath":"article/environment/redis.md","filePath":"article/environment/redis.md"}'),n={name:"article/environment/redis.md"},l=e(`<h1 id="redis环境配置" tabindex="-1">Redis环境配置 <a class="header-anchor" href="#redis环境配置" aria-label="Permalink to &quot;Redis环境配置&quot;">​</a></h1><p>基于CentOS7做命令演示，根据实际使用的Linux发行版灵活调整。</p><h2 id="_1-下载redis" tabindex="-1"><strong>1.下载Redis</strong> <a class="header-anchor" href="#_1-下载redis" aria-label="Permalink to &quot;**1.下载Redis**&quot;">​</a></h2><p>官网：<a href="https://redis.io/" target="_blank" rel="noreferrer">https://redis.io/</a></p><p>历史版本：<a href="http://download.redis.io/releases" target="_blank" rel="noreferrer">http://download.redis.io/releases</a></p><h2 id="_2-使用sftp工具上传到linux服务器" tabindex="-1"><strong>2.使用SFTP工具上传到Linux服务器</strong> <a class="header-anchor" href="#_2-使用sftp工具上传到linux服务器" aria-label="Permalink to &quot;**2.使用SFTP工具上传到Linux服务器**&quot;">​</a></h2><h2 id="_3-安装gcc" tabindex="-1"><strong>3.安装gcc</strong> <a class="header-anchor" href="#_3-安装gcc" aria-label="Permalink to &quot;**3.安装gcc**&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc-c++</span></span></code></pre></div><p>因为Redis是基于C语言编写的，所以需要安装gcc</p><p>安装好后通过指令<code>gcc -v</code>查看gcc版本</p><h2 id="_4-解压安装包" tabindex="-1"><strong>4.解压安装包</strong> <a class="header-anchor" href="#_4-解压安装包" aria-label="Permalink to &quot;**4.解压安装包**&quot;">​</a></h2><p>这里可以将程序移动到opt目录下（Linux默认的程序存放路径）</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis-7.2.4.tar.gz</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /opt</span></span></code></pre></div><p>对Redis文件进行解压</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis-7.2.4.tar.gz</span></span></code></pre></div><h2 id="_5-进入redis目录下-进行编译" tabindex="-1"><strong>5.进入Redis目录下，进行编译</strong> <a class="header-anchor" href="#_5-进入redis目录下-进行编译" aria-label="Permalink to &quot;**5.进入Redis目录下，进行编译**&quot;">​</a></h2><p>首先执行<code>make</code>命令，然后执行<code>make install</code>等待并确定所有都安装完成</p><p>Redis的默认安装路径：/usr/local/bin</p><h2 id="_6-将redis配置文件复制到bin目录下" tabindex="-1"><strong>6.将redis配置文件复制到bin目录下</strong> <a class="header-anchor" href="#_6-将redis配置文件复制到bin目录下" aria-label="Permalink to &quot;**6.将redis配置文件复制到bin目录下**&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redisconfig</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis-7.2.4/redis.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redisconfig</span></span></code></pre></div><p>之后再启动时，就使用此文件启动。</p><h2 id="_7-调整redis设置" tabindex="-1"><strong>7.调整Redis设置</strong> <a class="header-anchor" href="#_7-调整redis设置" aria-label="Permalink to &quot;**7.调整Redis设置**&quot;">​</a></h2><p>redis.conf</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 允许访问的地址，默认是127.0.0.1，会导致只能在本地访问。修改为0.0.0.0则可以在任意IP访问，生产环境不要设置为0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bind</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 守护进程，修改为yes后即可后台运行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">daemonize</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 密码，设置后访问Redis必须输入密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requirepass</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123321</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 监听的端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6379</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 工作目录，默认是当前目录，也就是运行redis-server时的命令，日志、持久化等文件会保存在这个目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 数据库数量，设置为1，代表只使用1个库，默认有16个库，编号0~15</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">databases</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置redis能够使用的最大内存</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">maxmemory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 512mb</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 日志文件，默认为空，不记录日志，可以指定日志文件名</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;redis.log&quot;</span></span></code></pre></div><h2 id="_8-启动redis-server服务" tabindex="-1"><strong>8.启动redis-server服务</strong> <a class="header-anchor" href="#_8-启动redis-server服务" aria-label="Permalink to &quot;**8.启动redis-server服务**&quot;">​</a></h2><p>通过制定配置文件启动服务：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redisconfig/redis.conf</span></span></code></pre></div><p>使用<code>redis-cli</code>连接测试</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6379</span></span></code></pre></div><p>如果设置了登录密码，则需要进行认证：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">auth</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 密码</span></span></code></pre></div><h2 id="_9-查看redis进程是否开启" tabindex="-1"><strong>9.查看Redis进程是否开启</strong> <a class="header-anchor" href="#_9-查看redis进程是否开启" aria-label="Permalink to &quot;**9.查看Redis进程是否开启**&quot;">​</a></h2><p>需要新建一个会话，执行以下命令：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ps</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span></code></pre></div><h2 id="_10-关闭redis服务" tabindex="-1"><strong>10.关闭redis服务</strong> <a class="header-anchor" href="#_10-关闭redis服务" aria-label="Permalink to &quot;**10.关闭redis服务**&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">shutdown</span></span></code></pre></div><h2 id="_11-设置redis开机自启动" tabindex="-1"><strong>11.设置Redis开机自启动</strong> <a class="header-anchor" href="#_11-设置redis开机自启动" aria-label="Permalink to &quot;**11.设置Redis开机自启动**&quot;">​</a></h2><p>首先新建一个系统服务文件：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/redis.service</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">redis-server</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">After</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">network.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">forking</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/usr/local/bin/redis-server</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /usr/local/bin/redisconfig/redis.conf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PrivateTmp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WantedBy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">multi-user.target</span></span></code></pre></div><p>然后重载系统服务</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre></div><p>执行以下命令，可以让Redis开机自启动：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span></code></pre></div><p>其他命令：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 停止</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重启</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span></code></pre></div>`,46),t=[l];function h(p,r,d,k,c,o){return a(),i("div",null,t)}const y=s(n,[["render",h]]);export{F as __pageData,y as default};
